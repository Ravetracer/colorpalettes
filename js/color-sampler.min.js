/*!
 * [color-sampler]{@link https://github.com/emn178/color-sampler}
 *
 * @version 0.1.5
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2016
 * @license MIT
 */
!function(t,e,o){"use strict";function i(e,o){this.canvas=t(e),this.options=o||{},this.enabled=!0,this.context=e.getContext("2d"),this.resize(),this.canvas.on("mousemove",this.onMousemove.bind(this)),this.canvas.on("mouseout",this.onMouseout.bind(this)),this.canvas.on("click",this.onClick.bind(this))}function n(){t(d).each(function(){t(this).data(p).resize()})}function s(){h=t('<div class="color-sampler-preview"/>');var e=t("<table/>");h.append(e);for(var o=0;11>o;++o){for(var i=t("<tr>"),n=0;11>n;++n){var s=t("<td></td>").attr("x",n).attr("y",o);f.push(s),i.append(s)}e.append(i)}t("body").append(h)}function a(){b||(b=!0,h.addClass("active"))}function r(){b&&(b=!1,h.removeClass("active"))}function c(){m=m.filter(d),m.each(function(){t(this).data(p).detect()}),0===m.length&&(l=clearInterval(l))}var h,l,p="color-sampler",d=":"+p,u=5,v=!1,f=[],b=!1,g=200,m=t();t.expr[":"][p]=function(e){return void 0!==t(e).data(p)},i.prototype.resize=function(){var t=this.canvas;this.bounds={left:parseInt(t.css("padding-left"))||0,top:parseInt(t.css("padding-top"))||0,right:t.width(),bottom:t.height()}},i.prototype.onMousemove=function(e){if(this.enabled){var o=this.canvas,i=this.bounds,n=e.offsetX-i.left,s=e.offsetY-i.top;if(this.inRange=n>=0&&s>=0&&n<i.right&&s<i.bottom,!this.inRange&&(-u>n||-u>s||n>=i.right+u||s>=i.bottom+u))return void r();h.css({left:e.pageX+5+"px",top:e.pageY+5+"px"});this.setupPreview(n,s);a(),this.color=f[60].css("background-color"),t.isFunction(this.options.onPreview)&&this.options.onPreview.call(o,this.color),this.canvas.trigger("sampler:preview",this.color)}},i.prototype.setupPreview=function(t,e){for(var o=t-5,i=e-5,n=this.context.getImageData(o,i,11,11).data,s=0,a=0;s<n.length;s+=4,++a){var r=parseInt(a/11)+i,c=a%11+o;if(0>c||0>r)f[a].css("background-color","white");else{var h="rgba("+Array.prototype.slice.call(n,s,s+4).join(",")+")";f[a].css("background-color",h)}}},i.prototype.onMouseout=function(){r()},i.prototype.onClick=function(e){this.color&&this.enabled&&this.inRange&&(t.isFunction(this.options.onSelect)&&this.options.onSelect.call(this.canvas,this.color),this.canvas.trigger("sampler:select",this.color))},i.prototype.detect=function(){(this.canvas.width()!=this.bounds.right||this.canvas.height()!=this.bounds.bottom)&&this.resize()},i.prototype.enable=function(t){void 0===t&&(t=!0),this.enabled=t},i.prototype.disable=function(t){void 0===t&&(t=!0),this.enabled=!t,r()};var y=["enable","disable","resize"];t.fn.colorSampler=function(a,r){var h,d="string"==typeof a;return this.filter("canvas").each(function(){d?-1!=t.inArray(a,y)&&(h=t(this).data(p),h&&h[a].apply(h,r)):(r=a,h=new i(this,r),t(this).data(p,h),v||(v=!0,s(),t(o).ready(function(){t(e).bind("resize",n)})),m=m.add(this),g&&!l&&(l=setInterval(c,g)))}),this},t.colorSamper={},t.colorSamper.setInterval=function(e){e==g||!t.isNumeric(e)||0>e||(g=e,l=clearInterval(l),g>0&&(l=setInterval(c,g)))}}(jQuery,window,document);